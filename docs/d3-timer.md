#d3-timerThismoduleprovidesanefficientqueuecapableofmanagingthousandsofconcurrentanimations,whileguaranteeingconsistent,synchronizedtimingwithconcurrentorstagedanimations.Internally,ituses[requestAnimationFrame](https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame)forfluidanimation(ifavailable),switchingto[setTimeout](https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/setTimeout)fordelayslongerthan24ms.##now(){#now}[Source](https://github.com/d3/d3-timer/blob/main/src/timer.js)·Returnsthecurrenttimeasdefinedby[performance.now](https://developer.mozilla.org/en-US/docs/Web/API/Performance/now)ifavailable,and[Date.now](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/now)ifnot.```jsd3.now()//1236.3000000715256```Thecurrenttimeisupdatedatthestartofaframe;itisthusconsistentduringtheframe,andanytimersscheduledduringthesameframewillbesynchronized.Ifthismethodiscalledoutsideofaframe,suchasinresponsetoauserevent,thecurrenttimeiscalculatedandthenfixeduntilthenextframe,againensuringconsistenttimingduringeventhandling.##timer(*callback*,*delay*,*time*){#timer}[Source](https://github.com/d3/d3-timer/blob/main/src/timer.js)·Schedulesanewtimer,invokingthespecified*callback*repeatedlyuntilthetimeris[stopped](#timer_stop).Anoptionalnumeric*delay*inmillisecondsmaybespecifiedtoinvokethegiven*callback*afteradelay;if*delay*isnotspecified,itdefaultstozero.Thedelayisrelativetothespecified*time*inmilliseconds;if*time*isnotspecified,itdefaultsto[now](#now).The*callback*ispassedthe(apparent)*elapsed*timesincethetimerbecameactive.Forexample:```jsconstt=d3.timer((elapsed)=>{console.log(elapsed);if(elapsed>200)t.stop();},150);```Thisproducesroughlythefollowingconsoleoutput:```325486585106125146167189209```(TheexactvaluesmayvarydependingonyourJavaScriptruntimeandwhatelseyourcomputerisdoing.)Notethatthefirst*elapsed*timeis3ms:thisistheelapsedtimesincethetimerstarted,notsincethetimerwasscheduled.Herethetimerstarted150msafteritwasscheduledduetothespecifieddelay.Theapparent*elapsed*timemaybelessthanthetrue*elapsed*timeifthepageisbackgroundedand[requestAnimationFrame](https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame)ispaused;inthebackground,apparenttimeisfrozen.If[timer](#timer)iscalledwithinthecallbackofanothertimer,thenewtimercallback(ifeligibleasdeterminedbythespecified*delay*and*time*)willbeinvokedimmediatelyattheendofthecurrentframe,ratherthanwaitinguntilthenextframe.Withinaframe,timercallbacksareguaranteedtobeinvokedintheordertheywerescheduled,regardlessoftheirstarttime.##*timer*.restart(*callback*,*delay*,*time*){#timer_restart}[Source](https://github.com/d3/d3-timer/blob/main/src/timer.js)·Restartatimerwiththespecified*callback*andoptional*delay*and*time*.Thisisequivalenttostoppingthistimerandcreatinganewtimerwiththespecifiedarguments,althoughthistimerretainstheoriginalinvocationpriority.##*timer*.stop(){#timer_stop}[Source](https://github.com/d3/d3-timer/blob/main/src/timer.js)·Stopsthistimer,preventingsubsequentcallbacks.Thismethodhasnoeffectifthetimerhasalreadystopped.##timerFlush(){#timerFlush}[Source](https://github.com/d3/d3-timer/blob/main/src/timer.js)·Immediatelyinvokeanyeligibletimercallbacks.Notethatzero-delaytimersarenormallyfirstexecutedafteroneframe(~17ms).Thiscancauseabriefflickerbecausethebrowserrendersthepagetwice:onceattheendofthefirsteventloop,thenagainimmediatelyonthefirsttimercallback.Byflushingthetimerqueueattheendofthefirsteventloop,youcanrunanyzero-delaytimersimmediatelyandavoidtheflicker.##timeout(*callback*,*delay*,*time*){#timeout}[Source](https://github.com/d3/d3-timer/blob/main/src/timeout.js)·Like[timer](#timer),exceptthetimerautomatically[stops](#timer_stop)onitsfirstcallback.Asuitablereplacementfor[setTimeout](https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/setTimeout)thatisguaranteedtonotruninthebackground.The*callback*ispassedtheelapsedtime.##interval(*callback*,*delay*,*time*){#interval}[Source](https://github.com/d3/d3-timer/blob/main/src/interval.js)·Like[timer](#timer),exceptthe*callback*isinvokedonlyevery*delay*milliseconds;if*delay*isnotspecified,thisisequivalentto[timer](#timer).Asuitablereplacementfor[setInterval](https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/setInterval)thatisguaranteedtonotruninthebackground.The*callback*ispassedtheelapsedtime.