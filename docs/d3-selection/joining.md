#JoiningdataForanintroduction,see[ThinkingWithJoins](http://bost.ocks.org/mike/join/)andthe[*selection*.joinnotebook](https://observablehq.com/@d3/selection-join).##*selection*.data(*data*,*key*){#selection_data}[Source](https://github.com/d3/d3-selection/blob/main/src/selection/data.js)·Bindsthespecifiedarrayof*data*withtheselectedelements,returninganewselectionthatrepresentsthe*update*selection:theelementssuccessfullyboundtodata.Alsodefinesthe[enter](#selection_enter)and[exit](#selection_exit)selectionsonthereturnedselection,whichcanbeusedtoaddorremoveelementstocorrespondtothenewdata.Thespecified*data*isanarrayofarbitraryvalues(*e.g.*,numbersorobjects),orafunctionthatreturnsanarrayofvaluesforeachgroup.Whendataisassignedtoanelement,itisstoredintheproperty`__data__`,thusmakingthedata“sticky”andavailableonre-selection.The*data*isspecified**foreachgroup**intheselection.Iftheselectionhasmultiplegroups(suchas[d3.selectAll](./selecting.md#selectAll)followedby[*selection*.selectAll](./selecting.md#selection_selectAll)),then*data*shouldtypicallybespecifiedasafunction.Thisfunctionwillbeevaluatedforeachgroupinorder,beingpassedthegroup’sparentdatum(*d*,whichmaybeundefined),thegroupindex(*i*),andtheselection’sparentnodes(*nodes*),with*this*asthegroup’sparentelement.Inconjunctionwith[*selection*.join](#selection_join)(ormoreexplicitlywith[*selection*.enter](#selection_enter),[*selection*.exit](#selection_exit),[*selection*.append](./modifying.md#selection_append)and[*selection*.remove](./modifying.md#selection_remove)),*selection*.datacanbeusedtoenter,updateandexitelementstomatchdata.Forexample,tocreateanHTMLtablefromamatrixofnumbers:```jsconstmatrix=[[11975,5871,8916,2868],[1951,10048,2060,6171],[8010,16145,8090,8045],[1013,990,940,6907]];d3.select("body").append("table").selectAll("tr").data(matrix).join("tr").selectAll("td").data(d=>d).join("td").text(d=>d);```Inthisexamplethe*data*functionistheidentityfunction:foreachtablerow,itreturnsthecorrespondingrowfromthedatamatrix.Ifa*key*functionisnotspecified,thenthefirstdatumin*data*isassignedtothefirstselectedelement,theseconddatumtothesecondselectedelement,andsoon.A*key*functionmaybespecifiedtocontrolwhichdatumisassignedtowhichelement,replacingthedefaultjoin-by-index,bycomputingastringidentifierforeachdatumandelement.Thiskeyfunctionisevaluatedforeachselectedelement,inorder,beingpassedthecurrentdatum(*d*),thecurrentindex(*i*),andthecurrentgroup(*nodes*),with*this*asthecurrentDOMelement(*nodes*[*i*]);thereturnedstringistheelement’skey.Thekeyfunctionisthenalsoevaluatedforeachnewdatumin*data*,beingpassedthecurrentdatum(*d*),thecurrentindex(*i*),andthegroup’snew*data*,with*this*asthegroup’sparentDOMelement;thereturnedstringisthedatum’skey.Thedatumforagivenkeyisassignedtotheelementwiththematchingkey.Ifmultipleelementshavethesamekey,theduplicateelementsareputintotheexitselection;ifmultipledatahavethesamekey,theduplicatedataareputintotheenterselection.Forexample,giventhisdocument:```html<divid="Ford"></div><divid="Jarrah"></div><divid="Kwon"></div><divid="Locke"></div><divid="Reyes"></div><divid="Shephard"></div>```Youcouldjoindatabykeyasfollows:```jsconstdata=[{name:"Locke",number:4},{name:"Reyes",number:8},{name:"Ford",number:15},{name:"Jarrah",number:16},{name:"Shephard",number:23},{name:"Kwon",number:42}];d3.selectAll("div").data(data,function(d){returnd?d.name:this.id;}).text(d=>d.number);```Thisexamplekeyfunctionusesthedatum*d*ifpresent,andotherwisefallsbacktotheelement’sidproperty.Sincetheseelementswerenotpreviouslyboundtodata,thedatum*d*isnullwhenthekeyfunctionisevaluatedonselectedelements,andnon-nullwhenthekeyfunctionisevaluatedonthenewdata.The*update*and*enter*selectionsarereturnedindataorder,whilethe*exit*selectionpreservestheselectionorderpriortothejoin.Ifakeyfunctionisspecified,theorderofelementsintheselectionmaynotmatchtheirorderinthedocument;use[*selection*.order](./modifying.md#selection_order)or[*selection*.sort](./modifying.md#selection_sort)asneeded.Formoreonhowthekeyfunctionaffectsthejoin,see[ABarChart,Part2](https://observablehq.com/@d3/lets-make-a-bar-chart/2)and[ObjectConstancy](http://bost.ocks.org/mike/constancy/).If*data*isnotspecified,thismethodreturnsthearrayofdatafortheselectedelements.Thismethodcannotbeusedtoclearbounddata;use[*selection*.datum](#selection_datum)instead.##*selection*.join(*enter*,*update*,*exit*){#selection_join}[Source](https://github.com/d3/d3-selection/blob/main/src/selection/join.js)·Appends,removesandreorderselementsasnecessarytomatchthedatathatwaspreviouslyboundby[*selection*.data](#selection_data),returningthe[merged](#selection_merge)enterandupdateselection.Thismethodisaconvenientalternativetotheexplicit[generalupdatepattern](https://observablehq.com/@d3/general-update-pattern),replacing[*selection*.enter](#selection_enter),[*selection*.exit](#selection_exit),[*selection*.append](./modifying.md#selection_append),[*selection*.remove](./modifying.md#selection_remove),and[*selection*.order](./modifying.md#selection_order).Forexample:```jssvg.selectAll("circle").data(data).join("circle").attr("fill","none").attr("stroke","black");```The*enter*functionmaybespecifiedasastringshorthand,asabove,whichisequivalentto[*selection*.append](./modifying.md#selection_append)withthegivenelementname.Likewise,optional*update*and*exit*functionsmaybespecified,whichdefaulttotheidentityfunctionandcalling[*selection*.remove](./modifying.md#selection_remove),respectively.Theshorthandaboveisthusequivalentto:```jssvg.selectAll("circle").data(data).join(enter=>enter.append("circle"),update=>update,exit=>exit.remove()).attr("fill","none").attr("stroke","black");```Bypassingseparatefunctionsonenter,updateandexit,youhavegreatercontroloverwhathappens.Andbyspecifyingakeyfunctionto[*selection*.data](#selection_data),youcanminimizechangestotheDOMtooptimizeperformance.Forexample,tosetdifferentfillcolorsforenterandupdate:```jssvg.selectAll("circle").data(data).join(enter=>enter.append("circle").attr("fill","green"),update=>update.attr("fill","blue")).attr("stroke","black");```Theselectionsreturnedbythe*enter*and*update*functionsaremergedandthenreturnedby*selection*.join.Youcananimateenter,updateandexitbycreatingtransitionsinsidethe*enter*,*update*and*exit*functions.Ifthe*enter*and*update*functionsreturntransitions,theirunderlyingselectionsaremergedandthenreturnedby*selection*.join.Thereturnvalueofthe*exit*functionisnotused.Formore,seethe[*selection*.joinnotebook](https://observablehq.com/@d3/selection-join).##*selection*.enter(){#selection_enter}[Source](https://github.com/d3/d3-selection/blob/main/src/selection/enter.js)·Returnstheenterselection:placeholdernodesforeachdatumthathadnocorrespondingDOMelementintheselection.(Theenterselectionisemptyforselectionsnotreturnedby[*selection*.data](#selection_data).)Theenterselectionistypicallyusedtocreate“missing”elementscorrespondingtonewdata.Forexample,tocreateDIVelementsfromanarrayofnumbers:```jsconstdiv=d3.select("body").selectAll("div").data([4,8,15,16,23,42]).enter().append("div").text(d=>d);```Ifthebodyisinitiallyempty,theabovecodewillcreatesixnewDIVelements,appendthemtothebodyin-order,andassigntheirtextcontentastheassociated(string-coerced)number:```html<div>4</div><div>8</div><div>15</div><div>16</div><div>23</div><div>42</div>```Conceptually,theenterselection’splaceholdersarepointerstotheparentelement(inthisexample,thedocumentbody).Theenterselectionistypicallyonlyusedtransientlytoappendelements,andisoften[merged](#selection_merge)withtheupdateselectionafterappending,suchthatmodificationscanbeappliedtobothenteringandupdatingelements.##*selection*.exit(){#selection_exit}[Source](https://github.com/d3/d3-selection/blob/main/src/selection/exit.js)·Returnstheexitselection:existingDOMelementsintheselectionforwhichnonewdatumwasfound.(Theexitselectionisemptyforselectionsnotreturnedby[*selection*.data](#selection_data).)Theexitselectionistypicallyusedtoremove“superfluous”elementscorrespondingtoolddata.Forexample,toupdatetheDIVelementscreatedpreviouslywithanewarrayofnumbers:```jsdiv=div.data([1,2,4,8,16,32],d=>d);```Sinceakeyfunctionwasspecified(astheidentityfunction),andthenewdatacontainsthenumbers[4,8,16]whichmatchexistingelementsinthedocument,theupdateselectioncontainsthreeDIVelements.Leavingthoseelementsas-is,wecanappendnewelementsfor[1,2,32]usingtheenterselection:```jsdiv.enter().append("div").text(d=>d);```Likewise,toremovetheexitingelements[15,23,42]:```jsdiv.exit().remove();```Nowthedocumentbodylookslikethis:```html<div>1</div><div>2</div><div>4</div><div>8</div><div>16</div><div>32</div>```TheorderoftheDOMelementsmatchestheorderofthedatabecausetheolddata’sorderandthenewdata’sorderwereconsistent.Ifthenewdata’sorderisdifferent,use[*selection*.order](./modifying.md#selection_order)toreordertheelementsintheDOM.Seethe[generalupdatepattern](https://observablehq.com/@d3/general-update-pattern)notebookformoreondatajoins.##*selection*.datum(value){#selection_datum}[Source](https://github.com/d3/d3-selection/blob/main/src/selection/datum.js)·Getsorsetsthebounddataforeachselectedelement.Unlike[*selection*.data](#selection_data),thismethoddoesnotcomputeajoinanddoesnotaffectindexesortheenterandexitselections.Ifa*value*isspecified,setstheelement’sbounddatatothespecifiedvalueonallselectedelements.Ifthe*value*isaconstant,allelementsaregiventhesamedatum;otherwise,ifthe*value*isafunction,itisevaluatedforeachselectedelement,inorder,beingpassedthecurrentdatum(*d*),thecurrentindex(*i*),andthecurrentgroup(*nodes*),with*this*asthecurrentDOMelement(*nodes*[*i*]).Thefunctionisthenusedtoseteachelement’snewdata.Anullvaluewilldeletethebounddata.Ifa*value*isnotspecified,returnsthebounddatumforthefirst(non-null)elementintheselection.Thisisgenerallyusefulonlyifyouknowtheselectioncontainsexactlyoneelement.ThismethodisusefulforaccessingHTML5[customdataattributes](http://www.w3.org/TR/html5/dom.html#custom-data-attribute).Forexample,giventhefollowingelements:```html<ulid="list"><lidata-username="shawnbot">ShawnAllen</li><lidata-username="mbostock">MikeBostock</li></ul>```Youcanexposethecustomdataattributesbysettingeachelement’sdataasthebuilt-in[dataset](http://www.w3.org/TR/html5/dom.html#dom-dataset)property:```jsselection.datum(function(){returnthis.dataset;})```##*selection*.merge(*other*){#selection_merge}[Source](https://github.com/d3/d3-selection/blob/main/src/selection/merge.js)·Returnsanewselectionmergingthisselectionwiththespecified*other*selectionortransition.Thereturnedselectionhasthesamenumberofgroupsandthesameparentsasthisselection.Anymissing(null)elementsinthisselectionarefilledwiththecorrespondingelement,ifpresent(notnull),fromthespecified*selection*.(Ifthe*other*selectionhasadditionalgroupsorparents,theyareignored.)Thismethodisusedinternallyby[*selection*.join](#selection_join)tomergethe[enter](#selection_enter)and[update](#selection_data)selectionsafterbindingdata.Youcanalsomergeexplicitly,althoughnotethatsincemergingisbasedonelementindex,youshoulduseoperationsthatpreserveindex,suchas[*selection*.select](./selecting.md#selection_select)insteadof[*selection*.filter](./selecting.md#selection_filter).Forexample:```jsconstodd=selection.select(function(d,i){returni&1?this:null;));consteven=selection.select(function(d,i){returni&1?null:this;));constmerged=odd.merge(even);```See[*selection*.data](#selection_data)formore.Thismethodisnotintendedforconcatenatingarbitraryselections,however:ifboththisselectionandthespecified*other*selectionhave(non-null)elementsatthesameindex,thisselection’selementisreturnedinthemergeandthe*other*selection’selementisignored.