<scriptsetup>import*asd3from"d3";constwidth=688;constheight=688;constouterRadius=Math.min(width,height)*0.5-30;constinnerRadius=outerRadius-20;constmatrix=[//toblack,blond,brown,red[11975,5871,8916,2868],//fromblack[1951,10048,2060,6171],//fromblond[8010,16145,8090,8045],//frombrown[1013,990,940,6907]//fromred];constcolors=["#000000","#ffdd89","#957244","#f26223"];constnames=["black","blond","brown","red"];constsum=d3.sum(matrix.flat());consttickStepMinor=d3.tickStep(0,sum,100);consttickStepMajor=d3.tickStep(0,sum,20);functiongroupTicks(d,step){constk=(d.endAngle-d.startAngle)/d.value;returnd3.range(0,d.value,step).map(value=>{return{value:value,angle:value*k+d.startAngle};});}constformatValue=d3.formatPrefix(",.0",tickStepMinor);constarc=d3.arc().innerRadius(innerRadius).outerRadius(outerRadius);constribbon=d3.ribbon().radius(innerRadius);constchords=d3.chord().padAngle(0.05).sortSubgroups(d3.descending)(matrix);</script><template><divstyle="margin:1em0;"><svg:width="width":height="height":viewBox="[-width/2,-height/2,width,height].join('')"fill="currentColor"style="font:10pxsans-serif;max-width:100%;height:auto;"><gv-for="dinchords.groups"><path:d="arc(d)":fill="colors[d.index]":stroke="colors[d.index]"><title>{{`${d.value.toLocaleString("en-US")}${names[d.index]}`}}</title></path><gv-for="dingroupTicks(d,tickStepMinor)":transform="`rotate(${d.angle*180/Math.PI-90})translate(${outerRadius},0)`"><linestroke="currentColor"x2="6"/><textv-if="d.value%tickStepMajor===0"x="8"dy="0.35em":transform="d.angle>Math.PI?'rotate(180)translate(-16)':null":text-anchor="d.angle>Math.PI?'end':null">{{formatValue(d.value)}}</text></g></g><gfill-opacity="0.67"stroke="var(--vp-c-bg)"><pathv-for="dinchords":d="ribbon(d)":fill="colors[d.target.index]"><title>{{`${d.source.value.toLocaleString("en-US")}${names[d.source.index]}→${names[d.target.index]}${d.source.index!==d.target.index?`\n${d.target.value.toLocaleString("en-US")}${names[d.target.index]}→${names[d.source.index]}`:``}`}}</title></path></g></svg><ahref="https://observablehq.com/@d3/chord-diagram/2?intent=fork"style="font-size:smaller;"target="_blank">Fork↗︎</a></div></template>