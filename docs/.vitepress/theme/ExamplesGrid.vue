<scriptsetup>import*asd3from"d3";import{ref,shallowRef,onMounted,onUnmounted}from"vue";import{data}from"./gallery.data.js";letobserver;letpointerframe;letclientX;constn=60;//maximumnumberofexamplestoshowconstslice=d3.shuffler(d3.randomLcg(d3.utcDay()))(data.slice()).slice(0,n);constsample=shallowRef(slice.slice(0,55));//initialguessconstcontainer=ref();constxn=ref(10);//numberofrowsconstyn=ref(5);//numberofcolumnsconstx=ref(0.5);//normalizedhorizontalpointerposition//Somebrowserstriggerpointermovemorefrequentlythandesirable,sowe//debounceeventsforasmoothtransitions.functiononpointermove(event){if(!pointerframe)pointerframe=requestAnimationFrame(afterpointermove);clientX=event.clientX;}functionafterpointermove(){pointerframe=null;x.value=clientX/document.body.clientWidth;}onMounted(()=>{observer=newResizeObserver(()=>{constw=parseFloat(getComputedStyle(container.value).getPropertyValue("--grid-width"));xn.value=Math.ceil(document.body.clientWidth/w)+3;//overflowcolumnsyn.value=Math.min(Math.round(640/w+2),Math.floor(n/xn.value));//640isgridheightsample.value=slice.slice(0,yn.value*xn.value);});observer.observe(document.body);addEventListener("pointermove",onpointermove);});onUnmounted(()=>{observer.disconnect();removeEventListener("pointermove",onpointermove);});</script><template><div:class="$style.examples"ref="container":style="`transform:translate(${60-x*10}vw,33%);`"><divv-for="(d,i)insample":style="`--delay:${((i%xn)/xn+(d3.randomLcg(1/i)())-0.4)*1}s;`"><a:href="`https://observablehq.com/${d.path}`":title="[d.title,d.author].join('\n')"target="_blank":style="`--x:${(i%xn)-xn/2+(Math.floor(i/xn)%2)*0.5};--y:${Math.floor(i/xn)-yn/2};`"><img:src="`https://static.observableusercontent.com/thumbnail/${d.thumbnail}.jpg`"width="640"height="400"/></a></div></div></template><stylemodule>.examples{position:relative;height:640px;transition:transform150msease-out;filter:drop-shadow(04px8pxrgba(0,0,0,0.2));--grid-width:140px;}@media(min-width:640px){.examples{--grid-width:160px;}}@media(min-width:960px){.examples{--grid-width:200px;}}/*Thedrop-shadowshouldnotbeaffectedbythehexagonclip-path.*/.examplesdiv{position:relative;transition:filter250msease-out;animation:fade-in350mscubic-bezier(0.215,0.610,0.355,1.000)var(--delay)backwards;}.examplesdiv:hover{filter:drop-shadow(04px8pxrgba(0,0,0,0.4));z-index:3;}.examplesa{position:absolute;--transform:perspective(75em)rotateX(30deg)rotateZ(-7deg)translate(calc(var(--x)*100%),calc(var(--y)*86.67%))scale(1.145);transform:var(--transform);animation:drop-in350mscubic-bezier(0.215,0.610,0.355,1.000)var(--delay)backwards;transition:transform250msease-out;clip-path:polygon(50.0%100.0%,93.3%75.0%,93.3%25.0%,50.0%0.0%,6.7%25.0%,6.7%75.0%);}.examplesa:hover{transform:var(--transform)translateZ(10px)scale(1.1);}.examplesimg{aspect-ratio:1;object-fit:cover;width:var(--grid-width);}@keyframesfade-in{from{filter:blur(20px);opacity:0;}to{filter:none;opacity:1;}}@keyframesdrop-in{from{transform:var(--transform)translateY(-100px)translateZ(400px);}to{transform:var(--transform);}}</style>