import{readFileSync}from"fs";importjsonfrom"@rollup/plugin-json";importnodeResolvefrom"@rollup/plugin-node-resolve";importterserfrom"@rollup/plugin-terser";importmetafrom"./package.json"assert{type:"json"};//ExtractcopyrightsfromtheLICENSE.constcopyright=readFileSync("./LICENSE","utf-8").split(/\n/g).filter(line=>/^Copyright\s+/.test(line)).map(line=>line.replace(/^Copyright\s+/,"")).join(",");constconfig={input:"bundle.js",output:{file:`dist/${meta.name}.js`,name:"d3",format:"umd",indent:false,extend:true,banner:`//${meta.homepage}v${meta.version}Copyright${copyright}`},plugins:[nodeResolve(),json()],onwarn(message,warn){if(message.code==="CIRCULAR_DEPENDENCY")return;warn(message);}};exportdefault[config,{...config,output:{...config.output,file:`dist/${meta.name}.mjs`,format:"esm"}},{...config,output:{...config.output,file:`dist/${meta.name}.min.js`},plugins:[...config.plugins,terser({output:{preamble:config.output.banner},mangle:{reserved:["InternMap","InternSet"]}})]}];